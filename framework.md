# 框架选型调研

## 第一阶段 对比各个已有框架优缺点

|          |                               robot+appium+adb                               |                            panda-libs                            |                            AutoStudio                            |                     pytest+uiautomator2+adb                      |
|:--------:|:----------------------------------------------------------------------------:|:----------------------------------------------------------------:|:----------------------------------------------------------------:|:----------------------------------------------------------------:|
|   环境依赖   |                            python+jdk+android sdk                            |                      python+jdk+android sdk                      |                                内置                                |                      python+jdk+android sdk                      |
|  需要掌握语法  |                               robot特殊语法+python                               |                              python                              |                              python                              |                              python                              |
| 基本框架完成状态 |                                      存在                                      |                                存在                                |                                存在                                |                                无                                 |
| 图形化使用界面  |                                     ride                                     |                         panda-web(浏览器展示)                         |                              cs架构自带                              |                                无                                 |
|  元素定位工具  |                               appium inspector                               |                             weditor                              |                               内置自带                               |                             weditor                              |
|  执行框架能力  |             robotframework，<br/>基础测试功能全具备，<br/>开源框架，<br/>有开源社区，              |                           自研，基础测试功能全具备                           |                           自研，基础测试功能全具备                           |           pytest,<br/>基础测试功能全具备，<br/>开源框架，有开源社区，插件最多，            |
|   执行方法   |                          ride界面执行<br/>命令行或pycharm执行                          |                panda-web 浏览器执行<br/>命令行或pycharm执行                 |                             CS架构工具执行                             |                          命令行或pycharm执行                           |
|  运行稳定性   |              本机需要一直开启cs架构的appium服务，可能会崩掉卡住，<br/>非google原生，运行速度慢              |              无需开启，应该会好点，uiautomator为google原生,运行速度快               |                    本机需一直开启cs架构的自研软件，可能会崩掉卡住，                     |              无需开启，应该会好点，uiautomator为google原生,运行速度快               |
|  关键字封装   |           基于robot语法编写，可复用，灵活性下降，<br/>不支持复杂语法，<br/>不利于提升测试人员代码编写能力            |  基于python语法编写,可复用，灵活性高，容易编写复杂功能，<br/>需要代码阅读能力，<br/>可提升测试人员代码能力   |  基于python语法编写,可复用，灵活性高，容易编写复杂功能，<br/>需要代码阅读能力，<br/>可提升测试人员代码能力   |  基于python语法编写,可复用，灵活性高，容易编写复杂功能，<br/>需要代码阅读能力，<br/>可提升测试人员代码能力   |
| 用例层展现形式  | 完美,基于robot语法可基本做到用例代码及测试步骤<br/>测试步骤:Launch Settings<br/>用例代码:Launch Settings | 纯python代码:<br/>测试步骤:Launch Settings<br/>用例代码:d.launch_settings() | 纯python代码:<br/>测试步骤:Launch Settings<br/>用例代码:d.launch_settings() | 纯python代码:<br/>测试步骤:Launch Settings<br/>用例代码:d.launch_settings() |
|  多机交互功能  |                                框架无，需重新考虑方案实现                                 |                               已实现                                |                               已实现                                |                          框架无，需重新考虑方案实现                           |

*          【方案一】（robot+appium+adb）:
                     优点: 1、已完成大量case编写，形成基于项目的公共keywords，继续使用，可以减少封装的时间成本（前提需要保证用例有效性）
                              2、robot语法在用例层面表现非常优秀，用例代码即测试步骤的表现方式很容易理解测试步骤（不需要注释）
                              3、开源框架优点，网上基本可以找到相关使用方法
                     缺点：1、底层执行服务使用appium，本地执行时需要同时长期挂载，容易出现软件崩溃导致用例执行断开
                              2、robot语法在关键字封装层灵活性不够，基本还是需要Python完成在进行对Python封装，因此需要掌握两套语法，
                              3、大量使用基于特定工具语法，不利于提升通用语言代码能力
*           【方案二】（panda-libs(自研)）:
                     优点: 1、本机无需开启其他软件服务，用例执行崩溃率降低
                              2、已完成基础平台化，实现许多定制功能，如远程执行，多机执行，交互，飞书通知，报告持久化等
                              3、有专门团队人员了解成套框架平台的原理，可以继续维护或新增功能。人员：罗宇琦，文强，张海波
                     缺点：1、自研框架通用缺点，只能使用本框架提供的api，对查找框架api能力要求较高，
                              3、目前无gm相关项目实现，需要重新编写相关关键字
*           【方案三】（AutoStudio(自研))）:
                     优点: 1、环境相关依赖全部内置，安装方便
                              2、元素定位工具体验感最好
                              3、把通用方法安置到最外层目录下，方便寻找通用api
                     缺点：1、需要一直开启c/s软件服务，软件性能差，运行慢，长期挂载可能会导致软件卡住而无法正常完成用例
                                2、存在一些已知bug但无团队继续维护
*           【方案四】（pytest+uiautomator2+adb）:
                     优点: 1、运行速率快，本机不开启软件服务，
                              2、开源框架优点，各种问题基本都能在网上找到解决办法i
                     缺点：1、还未开始，需要从0到1重新设计框架

## 第二阶段 计算框架成本

|           | AutoStudio | panda-libs | Robot Framework+Appium |                       差异主要原因                        |
|:---------:|:----------:|:----------:|:----------------------:|:---------------------------------------------------:|
| 学习成本（人/天） |     16     |     21     |           18           |            基于框架是否完成过相关车机项目，有项目的框架学习成本会降低            |
|   工具维护    |     无      |    140     |           无            | robot框架是基于当前项目完成的，其他扩展功能未实现<br/>AutoStudio/RF暂时无法维护 |
|   执行成本    |     3      |     1      |           2            |                   本地是否需要额外开启软件服务                    |

------

| AutoStudio |                                                   |                                  |                                                          |                                                                                        ||
|:----------:|:-------------------------------------------------:|:--------------------------------:|:--------------------------------------------------------:|:--------------------------------------------------------------------------------------:|:-----------------------------------------------------:|
|    项目现状    |    现存4644条自动化用例，有记录统计成功率为55.8%（大约2020年上半年统计记录）    |                                  |                                                          |                                                                                        |
|    使用难点    | 自带编辑器界面，且只能用该编辑器打开项目，无法使用pycharm等编辑器（性能不如pycharm） | 运行用例前的选择设备、导入套件等执行操作经常无响应，需要频繁操作 | 内置编辑器的debug模式非常难用，无法提供堆栈信息，后续调试用例时间会加长，且无法使用其他编辑器进行debug | 出现崩溃后需要进行各类环境清理才能继续使用         使用软件多次进行执行退出操作，大概率出现提示设备占用，提供的杀进程bat文件无法成功杀掉，需要重启电脑处理 处理 |
|    学习成本    |                 python基础语法学习: 5人天                 |          掌握全流程环境搭建: 1人天          |               基于现有项目梳理大致框架使用（无项目时间*2）:2人天                |                          基于现有项目提供的关键字编写自动化用例能力掌握（无项目时间*2）:5人天                          |               学会debug模式进行自动化用例调试批跑:3人天                |
|    工具维护    |            工具开发人员不在项目中，技术栈不确定，无法进行软件维护            |                                  |                                                          |                                                                                        ||

------

| Robot Framework+Appium |                                 |                |                             |                                      |||
|:----------------------:|:-------------------------------:|:--------------:|:---------------------------:|:------------------------------------:|:-----------------------------------------------------:|:-----------------------------------------------------:|
|          项目现状          | 现存852条自动化用例，统计成功率为38.9%，且无法全量通跑 |                |                             |                                      ||
|          使用难点          |  在部分测试场景中极高概率导致appium服务停止，测试失败  |                |                             |                                      ||
|          学习成本          |        python基础语法学习: 5人天        | 掌握全流程环境搭建: 2人天 | 基于现有项目梳理大致框架使用（无项目时间*2）:2人天 | 基于现有项目提供的关键字编写自动化用例能力掌握（无项目时间*2）:4人天 |               学会debug模式进行自动化用例调试批跑:3人天                |robot特殊语法学习:2人天 |
|          工具维护          |           外部开源框架，难以维护           |                |                             |                                      |||

------

| panda-libs |                                          |                           |                             |                                      ||||
|:----------:|:----------------------------------------:|:-------------------------:|:---------------------------:|:------------------------------------:|:-----------------------------------------------------:|:-----------------------------------------------------:|:----------------------------------:|
|    项目现状    |                    无                     |                           |                             |                                      |||
|    使用难点    | 当前所有api全在一个对象上，没有整理出常用api，需要花时间编写通用api文件 | 需要掌握框架指定的配置文件参数,布局，否则无法运行 |                             |                                      |||
|    学习成本    |            python基础语法学习: 5人天             |      掌握全流程环境搭建: 2人天       | 基于现有项目梳理大致框架使用（无项目时间*2）:4人天 | 基于现有项目提供的关键字编写自动化用例能力掌握（无项目时间*2）:7人天 |               学会debug模式进行自动化用例调试批跑:3人天                |||
|    工具维护    |      掌握python高级语法应用，装饰器，魔法方法等:10人天       |  掌握python多线程，线程池运用 :10人天  |  掌握uiautomator运行原理   :15人天  |       掌握panda-libs脚本执行原理:25人天        |掌握插件开发机制:20人天|掌握web后端开发，django:30人天 |掌握web前端开发，angular2，typescript:30人天  |

## 第三阶段 AutoStdio框架使用调研

|  | 2023/2/1                                        | 2023/2/2                                                                                                                                      | 2023/2/3                                                                                                                                                                        | 2023/2/6                                    | 2023/2/7                                             | Summary                                           |
|:----------:|:------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------|:-----------------------------------------------------|:-----------------------------------------------------|
|    台式1     | 无                                               | 开始时间：2023-02-01 20:42:52<br/>持续时间：12时58分35秒<br/>用例总数：798<br/>执行个数：730<br/>未完成：68<br/>测试状态：执行正常，人为停止<br/>执行效率：1.07 分/条<br/>发生问题：无              | 开始时间：2023-02-02 18:42:25<br/>持续时间：13时51分37秒<br/>用例总数：798<br/>执行个数：798<br/>未完成：0<br/>测试状态：正常<br/>执行效率：1.05 分/条<br/>发生问题：无                                                        |     开始时间：2023-02-03 18:24:45<br/>持续时间：14时7分42秒<br/>用例总数：798<br/>执行个数：798<br/>未完成：0<br/>测试状态：正常<br/>执行效率：1.06分/条<br/>发生问题：无                                        |开始时间：2023-02-06 20:21:14<br/>持续时间：13时23分33秒<br/>用例总数：798<br/>执行个数：636<br/>未完成：162<br/>测试状态：执行正常，人为停止<br/>执行效率：1.26分/条<br/>发生问题：无|测试总时长：3259分钟（54h19分）<br/>用例总数：3192<br/>执行个数：2962<br/>未完成：230<br/>执行效率：1.1分/条<br/>发生问题：无|
|    笔记本1    | 开始时间：2023-01-31 18:02:59<br/>持续时间：2时22分1秒<br/>用例总数：798<br/>执行个数：180<br/>未完成：618<br/>测试状态：执行卡住，用例没有继续进行<br/>执行效率：0.78 分/条<br/>发生问题：1.测试执行卡住，无法继续往下执行        | 开始时间：2023-02-01 21:41:22<br/>持续时间：12时10分20秒<br/>用例总数：798<br/>执行个数：798<br/>未完成：0<br/>测试状态：正常<br/>执行效率：0.91 分/条<br/>发生问题：无                                                                                                                    | 开始时间：2023-02-02 19:51:22<br/>持续时间：14时14分40秒<br/>用例总数：798<br/>执行个数：586<br/>未完成：213<br/>测试状态：执行正常，人为停止<br/>执行效率：1.46 分/条<br/>发生问题：1.部分测试用例耗时异常，最长41分/条                            |                   开始时间：2023-02-03 18:54:48<br/>持续时间：18时5分29秒<br/>用例总数：798<br/>执行个数：798<br/>未完成：0<br/>测试状态：正常<br/>执行效率：1.36 分/条<br/>发生问题：1.部分测试用例耗时异常，最长45分/条                          |开始时间：2023-02-06 20:05:39<br/>持续时间：13时39分57秒<br/>用例总数：798<br/>执行个数：478<br/>未完成：320<br/>测试状态：执行正常，人为停止<br/>执行效率：1.71 分/条<br/>发生问题：1.部分测试用例耗时异常，最长36分/条|测试总时长：3630分钟（60h30分）<br/>用例总数：3990<br/>执行个数：2840<br/>未完成：1150<br/>执行效率：1.28分/条<br/>发生问题：1.测试执行卡住，无法继续往下执行2.部分测试用例耗时异常|
|    笔记本2    | 开始时间：2023-01-31 19:30:29<br/>持续时间：14时4分54秒<br/>用例总数：798<br/>执行个数：478<br/>未完成：325<br/>测试状态：执行卡住，用例没有继续进行<br/>执行效率：1.77 分/条<br/>发生问题：1.测试执行卡住，无法继续往下执行2.部分测试用例耗时异常，最长40分/条                              | 开始时间：2023-02-01 20:27:57<br/>持续时间：13时17分34秒<br/>用例总数：798<br/>执行个数：747<br/>未完成：51<br/>测试状态：执行正常，人为停止<br/>执行效率：1.07分/条<br/>发生问题：无                                                                                                                            | 开始时间：2023-02-02 19:05:19<br/>持续时间：14时26分<br/>用例总数：798<br/>执行个数：647<br/>未完成：151<br/>测试状态：执行正常，人为停止<br/>执行效率：1.34分/条<br/>发生问题：1.部分测试用例耗时异常，最长33分/条                                                                                                              | 开始时间：2023-02-03 21:31:57<br/>持续时间：16时30分40秒<br/>用例总数：798<br/>执行个数：798<br/>未完成：0<br/>测试状态：正常<br/>执行效率：1.24分/条<br/>发生问题：无       | 开始时间：2023-02-06 20:14:43<br/>持续时间：13时27分19秒<br/>用例总数：798<br/>执行个数：643<br/>未完成：155<br/>测试状态：执行正常，人为停止<br/>执行效率：1.25分/条<br/>发生问题：无                           |测试总时长：4304分钟（60h44分）<br/>用例总数：3990<br/>执行个数：3313<br/>未完成：677<br/>执行效率：1.3分/条<br/>发生问题：1.测试执行卡住，无法继续往下执行2.部分测试用例耗时异常|